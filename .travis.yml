sudo: required

language: python

python:
  - 2.7
  - 3.6

services:
  - docker

before_install:
  - travis_wait script/up

script:
  - script/test

jobs:
  include:
    - stage: distribute
      if: branch = master AND type != pull_request
      install: skip
      script:
        - docker login -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD";
        - script/distribute;
